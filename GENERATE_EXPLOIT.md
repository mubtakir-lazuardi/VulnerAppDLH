# ğŸ›¡ï¸ GENERATE_EXPLOIT.md

This document confirms that testing has been performed using **Droid-LLM-Hunter (DLH)** on the target application **VulnAppDLH**.

**Command Executed:**
```bash
python dlh.py scan VulnerAppDLH.apk --generate-exploit
```

The following vulnerability categories have been tested and verified:

1. ğŸ” Hardcoded Secrets & Insecure Storage
2. ğŸ’‰ SQL Injection
3. ğŸŒ WebView Exploits
4. ğŸ”¢ GraphQL Injection
5. ğŸ“‚ Insecure File Operations
6. ğŸ”“ Weak Cryptography & Auth Bypass
7. ğŸ”„ IPC & Exported Components

All vulnerability reports and generated exploits are stored in the `Report-DLH` directory.

## ğŸ“Š Verified Vulnerability Table

| Vulnerability Category | DLH Rules Enabled | ğŸ“‚ Folder Report | âœ… Verified Exploit |
| :--- | :--- | :--- | :--- |
| **1. Hardcoded Secrets & Insecure Storage** | `insecure_storage: true`<br>`hardcoded_secrets: true` | [Report-DLH/HardcodedSecrets_InsecureStorage](Report-DLH/HardcodedSecrets_InsecureStorage) | âœ… (Code Analysis)<br>âœ… (Shell Script) |
| **2. SQL Injection** | `sql_injection: true` | [Report-DLH/SQLInjection](Report-DLH/SQLInjection) | âœ… (Shell Script) |
| **3. WebView Exploits** | `webview_xss: true`<br>`webview_deeplink: true`<br>`insecure_webview: true` | [Report-DLH/WebViewExploits](Report-DLH/WebViewExploits) | âœ… (Shell + HTML) |
| **4. GraphQL Injection** | `graphql_injection: true` | [Report-DLH/GraphQLInjection](Report-DLH/GraphQLInjection) | âœ… (Python Clean) |
| **5. Insecure File Operations** | `insecure_storage: true`<br>`path_traversal: true` | [Report-DLH/InsecureFileOperations](Report-DLH/InsecureFileOperations) | âœ… (Python Clean) |
| **6. Weak Cryptography, Auth Bypass & Logic Flaws** | `insecure_random_number_generation: true`<br>`biometric_bypass: true`<br>`universal_logic_flaw: true` | [Report-DLH/WeakCryptography_AuthBypass](Report-DLH/WeakCryptography_AuthBypass) | âœ… (Python + UIAuto) |
| **7. IPC & Exported Components** | `exported_components: true`<br>`intent_spoofing: true`<br>`deeplink_hijack: true` | [Report-DLH/IPC_ExportedComponents](Report-DLH/IPC_ExportedComponents) | âœ… (Shell + HTML) |

---

## ğŸ› ï¸ Technical Methodology & Environment

**Methodology:**
DLH utilizes a **Hybrid Analysis Engine** that combines:
1.  **Static Analysis (SAST):** Decompilation via JADX to extract source code and Manifest configurations.
2.  **LLM Logic Analysis:** AI-driven code walkthroughs to identify logic flaws (Context-Aware).
3.  **Dynamic Exploit Generation:** Automated creation of Python/Shell scripts based on identified attack vectors.

**Recommended Test Environment:**
*   **Target OS:** Android 11 - 14 (Emulator or Physical Device).
*   **Tools Required:** `adb`, `python3`, `uiautomator`.
*   **Root Access:** Recommended for full verification of storage-based attacks.

**Analysis Types: Manifest-Only vs Hybrid:**
Understanding the detection scope helps optimize scan times:
*   ğŸ“„ **Manifest-Only Rules:** Purely analyze `AndroidManifest.xml`.
    *   `exported_components` (Checks for `exported="true"` without permission).
    *   `deeplink_hijack` (Checks for generic host wildcards).
*   ğŸ§  **Hybrid Rules (Code + Manifest):** Require analyzing Java/Kotlin code logic.
    *   `intent_spoofing` (Checks if receiver verifies `getCallingPackage()`).
    *   `webview_deeplink` (Checks if data from Intent is actually loaded into WebView).
    
---

## âš ï¸ Important Notes & Limitations

### âš¡ Root Access Requirement
> [!IMPORTANT]
> Some vulnerabilities, specifically **Insecure Storage** (reading private files) and **Insecure File Permissions**, require **ROOT access** to fully exploit on a standard device. Without root, the `adb shell` user cannot access `/data/data/com.app/files/` directly.

### ğŸš« "World-Readable" File Blocking on Modern Android
During testing for `MODE_WORLD_READABLE` vulnerabilities, you might observe that the exploit script fails with "File not found". This is **EXPECTED BEHAVIOR** on Android 7.0+ (Nougat) and newer.

**Explanation:**
1. When the exploit script runs (pressing the button), the app attempts to execute: `openFileOutput("public_secret.txt", MODE_WORLD_READABLE)`.
2. The Android OS intercepts this call and throws a **SecurityException**: `"MODE_WORLD_READABLE no longer supported"`.
3. The app catches this exception (or crashes), and the file `public_secret.txt` is **NEVER CREATED**.
4. Consequently, the Python script reports that the file cannot be found.
> [!NOTE]
> This is not a failure of the script, but a security feature of the OS that forcibly mitigates this specific vulnerability.

---

## ğŸ¤– AI Agent Usage
The exploits generated in this report were created with the assistance of the following AI Agents:
*   âœ¨ **Gemini**
*   ğŸ§  **Anthropic**
*   ğŸŒ **OpenRouter**

### Manual Validation & Correction
Please note that while the AI agents are powerful, the generated exploit scripts **may not be perfect immediately**. During this testing session, several scripts required manual refinement to function correctly (e.g., adjusting UI coordinates, fixing shell escaping, or correcting logic flows).

> [!CAUTION]
> **Disclaimer:**
> Droid-LLM-Hunter design is to **complement**, not replace, human security analysts. All generated findings and scripts must be **manually validated**. Users should be prepared to debug and refine exploit scripts to suit the specific environment and OS version of the target device.
